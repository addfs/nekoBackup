# nekoBackup 1.3

nekoBackup — утилита для создания регулярных бекапов данных на вашем сервере. На текущий момент поддерживаются следующие виды бекапов:

* простой архив директории,
* архивы поддиректорий в директориях,
* базы данных mysql (с помощью mysqldump),
* базы данных postgres (с помощью pg_dump).

Бекапы можно сохранить:

* в файловой системе,
* в хранилище Amazon S3.

## Требования

* php-cli 5.3+
* composer.phar

## Установка

Поскольку скрипту нужен полный доступ ко всем директориям, указанным в конфиге, желательно запускать его от имени
суперпользователя. После распаковки скриптов запустите установку зависимостей:

`composer.phar install`

## Настройка

Настройка осуществляется с помощью yaml-файлов в директории config.
Перед редактированием настроек советую прочитать о синтаксисе [языка разметки yaml](http://ru.wikipedia.org/wiki/YAML).

### Изначальная настройка

Скопируйте файлы [config.yaml.example](https://github.com/druidvav/nekoBackup/blob/master/config/config.yaml.example)
в config.yaml и [schedule.yaml.example](https://github.com/druidvav/nekoBackup/blob/master/config/schedule.yaml.example)
в schedule.yaml и отредактируйте их в соответствии с комментариями.

### Amazon S3 `s3.yaml`

Скопируйте [s3.yaml.example](https://github.com/druidvav/nekoBackup/blob/master/config/s3.yaml.example) в
s3.yaml и отредактируйте его в соответствии с комментариями. Крайне важно, чтобы на файл s3.yaml стояли права
0600, а владельцем был пользователь, которым вы запускете скрипт. При загрузке в Amazon S3 директория `storage`
используется для хранения временных файлов.

## Использование

`php nbackup.php backup [-i] [basic|s3]`

* Запускает архивирование данных в директорию storage в соответствии с текущей датой.
* `-i` запускает полный бекап всех данных, а не только назначенных на текущую дату расписанием.
* `basic` или `s3` — способ резервного копирования: в файловую систему или в Amazon S3.

`php nbackup.php install [basic|s3]`

* Добавляет задачу архивирования указанным способом в crontab.
* `basic` или `s3` — способ резервного копирования: в файловую систему или в Amazon S3.